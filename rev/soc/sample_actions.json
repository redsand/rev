{"id":"5b3ad283-c46d-45d5-833f-f63b6e01d04f585","cmd":"actions","route":"get","recursive":true,"data":[{"@rid":"#1004:0","group_id":"d5b8e698-89f1-4222-8585-f06ab4e83649","name":"JitBit HAWK.io Escalate","description":"Escalate","app_id":"#412:0","module":"playbook.record.CreateTicket","config":{"url":"https://support.hawk.io","credential":"c175a189-b040-4a63-a0c5-fedf50d5c56a"},"enabled":true,"dateUpdated":"2025-06-03T16:59:05.000Z","dateAdded":"2025-06-03T16:59:05.000Z","category_id":"notify","action_id":"playbook.record.CreateTicket","module_id":"jitbit","code":"//! Global vm for interacting with base\nlet g_vm;\n\n//! List of recipients for escalation\nlet recipientList = [ ]\n\n//! Jitbit User Profile of Submitter\nlet userProfile = { }\n\n//! Get Module ID - return the name/key/id of this function. Must match with app data inside marketplace\nexport function getModuleId() { return \"jitbit\" }\n\n//! Write ID - actionItems\nexport function showActionSettings(vm) {\n  console.log('Inside JITBIT Module showActionSettings')\n  g_vm = vm\n  if(!g_vm.token || g_vm.token.length == 0) {\n    g_vm.$bvModal.show('token-modal-escalate')\n    return\n  }\n\n  // get categories and\n  let x = vm.actions.filter((x) => x['@rid'] == vm.data.action_id)\n  let body = { token: vm.token, action_id: x[0]['@rid'], credential_id: x[0].config.credential, group_id: x[0].group_id }\n  vm.loading_3rdparty = true\n  vm.fetchActionItem({\n    token: vm.token,\n    socket: vm.$socket,\n    callback: getActionResponse,\n    cmd: getModuleId(),\n    route: 'settings',\n    data: body\n  })\n}\n\nexport function getActionResponse(data, err) {\n\n  console.log(data)\n  console.log(err)\n  if(!data) {\n    console.log('Failed to prompt. need to retry')\n    g_vm.token = ''\n    g_vm.$bvModal.show('token-modal-escalate')\n    return\n  }\n\n  userProfile = data.user\n\n  let html = '<tr class=\\"row\\">' +\n            '<td class=\\"col-sm-2 align-middle ml-2\\">Jitbit Category:</td>' +\n            '<td class=\\"col-sm-9 align-left\\">' +\n            '<select id=\\"jitbitCategorySelection\\" class=\\"form-control\\">'\n\n  let i\n  for(i=0; i < data.categories.length; i+=1) {\n      html += '<option value=\\"' + data.categories[i].CategoryID + '\\"'\n      if(data.categories[i].Name.toUpperCase().indexOf(g_vm.caseData.risk_level.toUpperCase()) != -1) {\n        html += ' selected'\n      }\n      html += '>' + data.categories[i].Name + '</option>'\n  }\n  html += '</select>' +\n          '</td></tr>'\n\n  $('#actionBody > tr').eq(1).after(html)\n\n  let jitbitPriorities = [\n        { value: 2, name: \"Critical\" },\n        { value: 1, name: \"High\" },\n        { value: 0, name: \"Normal\" },\n        { value: -1, name: \"Low\" }\n      ]\n\n  html = '<tr class=\\"row\\">' +\n            '<td class=\\"col-sm-2 align-middle ml-2\\">Jitbit Priority:</td>' +\n            '<td class=\\"col-sm-9 align-left\\">' +\n            '<select id=\\"jitbitPrioritySelection\\" class=\\"form-control\\">'\n\n  let priorityFound = false\n  for(i=0; i < jitbitPriorities.length; i+=1) {\n      html += '<option value=\\"' + jitbitPriorities[i].value + '\\"'\n      if(jitbitPriorities[i].name.toUpperCase().indexOf(g_vm.caseData.risk_level.toUpperCase()) != -1) {\n          html += ' selected'\n          priorityFound = true\n      }\n      html += '>' + jitbitPriorities[i].name + '</option>'\n  }\n  html += '</select>' +\n          '</td></tr>'\n\n  $('#actionBody > tr').eq(2).after(html)\n\n  if(!priorityFound) {\n    // set option as Low\n    $(function() {\n        $(\\"#jitbitPriorityDiv\\").val('-1');\n    });\n  }\n\n\n  html = '<tr class=\\"row\\">' +\n            '<td class=\\"col-sm-2 align-middle ml-2\\">Jitbit Reporter:</td>' +\n            '<td class=\\"col-sm-9 align-left\\">' + '<span class=\\"badge badge-secondary\\">' + data.user.FullNameAndLogin + ' (' + data.user.UserID + ')</span>'\n            '</td></tr>'\n\n  $('#actionBody > tr').eq(3).after(html)\n\n\n  html = '<tr class=\\"row\\">' +\n            '<td class=\\"col-sm-2 align-middle ml-2\\">Jitbit Company:</td>' +\n            '<td class=\\"col-sm-9 align-left\\">' +\n            '<select id=\\"jitbitCompanySelection\\" class=\\"form-control\\">'\n\n  for(i=0; i < data.companies.length; i+=1) {\n      html += '<option value=\\"' + data.companies[i].CompanyID + '\\"'\n      if(data.companies[i].Name.toUpperCase().indexOf(g_vm.user.groupHash[g_vm.caseData.group_id].name.toUpperCase()) != -1) {\n        html += ' selected'\n      }\n      html += '>' + data.companies[i].Name + '</option>'\n\n  }\n  html += '</select>' +\n          '</td></tr>'\n\n  $('#actionBody > tr').eq(4).after(html)\n\n  $('#jitbitCompanySelection').on('change', function(e) {\n    console.log('Company changed.')\n    console.log(e)\n    getRecipients($('#jitbitCompanySelection').val())\n  })\n\n  html = '<tr class=\\"row\\">' +\n          '  <td class=\\"col-sm-2 ml-2 align-middle\\">Recipient(s):</td>' +\n          '  <td class=\\"col-sm-9\\">' +\n          '   <div class=\\"input-group\\">' +\n          '    <div id=\\"recipientListDiv\\" style=\\"width: 95%\\" class=\\"align-self-center text-middle\\">'\n\n  html += '  </div>' +\n          '    <div id=\\"addRecipientsButton\\" class=\\"align-items-end\\" style=\\"\\">' +\n          '        <button' +\n          '          class=\\"btn btn-secondary btn-small waves-effect waves-light\\"' +\n          '          type=\\"button\\"' +\n          '        >' +\n          '          <i class=\\"fas fa-plus\\"></i>' +\n          '        </button>' +\n          '    </div>' +\n          '  </div>' +\n          '  <div id=\\"jitbitRecipientDiv\\"></div>'\n\n  html += '  </td>' +\n          '</tr>'\n\n  $('#actionBody > tr').eq(5).after(html)\n\n  console.log('Current company value: ' + $('#jitbitCompanySelection').val())\n  if( $('#jitbitCompanySelection').val().length > 0 ) {\n    getRecipients($('#jitbitCompanySelection').val())\n  }\n  $('#jitbitRecipientDiv').hide()\n\n  $('#addRecipientsButton > button').click(function() {\n    $('#jitbitRecipientDiv').show()\n    $('#addRecipientsButton').hide()\n  })\n\n  // lookup available users by company\n\n  g_vm.loading_3rdparty = false\n\n  //! build our data selects - Company, Reporter, Priority, Category\n\n}\n\n//! Destructor - Remove all added fields\nexport function removeFields() {\n  let rowCount = $('#actionBody tr').length;\n  console.log('Removing fields')\n  console.log(rowCount)\n  if (rowCount < 7) return // added fields not found\n\n  $(\\"#actionBody tr:nth-child(2)\\").remove()\n  $(\\"#actionBody tr:nth-child(2)\\").remove()\n  $(\\"#actionBody tr:nth-child(2)\\").remove()\n  $(\\"#actionBody tr:nth-child(2)\\").remove()\n  $(\\"#actionBody tr:nth-child(2)\\").remove()\n\n}\n\n//! Remove recipient from our internal list\nexport function removeRecipient(recipient) {\n\n   let x = recipientList.filter((v) => v[0] == recipient)\n\n   let i\n   for(i=0; i < recipientList.length; i+=1) {\n     if(recipientList[i][0] == recipient) {\n       recipientList.splice(i, 1)\n       break\n     }\n   }\n\n   listRecipients()\n}\n\n//! Add recipient to internal list\nexport function addRecipient(user_id, fullname) {\n\n   console.log('Adding recipient')\n   console.log(user_id, fullname)\n\n   let x = recipientList.filter((v) => v[0] == user_id)\n   if (x.length > 0) {\n     console.log('addRecipeint: user already on list, ignoring')\n     return\n   }\n\n   recipientList.push( [ user_id, fullname ] )\n\n   listRecipients()\n}\n\n//! List recipients - draw select options\nexport function listRecipients() {\n\n  let html = ''\n  let i\n\n  for(i=0; i < recipientList.length; i+= 1) {\n      html += '<span class=\\"badge badge-danger mb-1 mr-2\\">' + recipientList[i][1] + ' <a data-id=\\"' + recipientList[i][0] + '\\" style=\\"color: #fff\\" class=\\"recipientLink\\" href=\\"javascript:void(0)\\">x</a></span>'\n  }\n\n  if (recipientList.length == 0)\n      html += '<span class=\\"align-self-center text-middle mb-1 mr-2\\">No recipients specified.</span>'\n\n  $('#recipientListDiv').html(html)\n  $('.recipientLink').on('click', function() {\n    let id = $(this).data('id')\n    console.log('Removing: ' + id)\n    removeRecipient(id)\n  })\n\n}\n\n//! Get Recipients - get list of recipients by company id\nexport function getRecipients(company_id) {\n\n  // set loading\n  $('#jitbitRecipientDiv').html('<div class=\\"spinner-grow avatar-md text-secondary m-2\\"></div>')\n\n  let x = g_vm.actions.filter((x) => x['@rid'] == g_vm.data.action_id)\n  let body = { token: g_vm.token, action_id: x[0]['@rid'], credential_id: x[0].config.credential, group_id: x[0].group_id, company_id: company_id }\n  g_vm.loading_3rdparty = true\n  g_vm.fetchActionItem({\n    token: g_vm.token,\n    socket: g_vm.$socket,\n    callback: getRecipientsResponse,\n    cmd: getModuleId(),\n    route: 'recipients',\n    data: body\n  })\n\n}\n\n//! Get Recipients Response - handle the data returned from request\nexport function getRecipientsResponse(data, err) {\n\n  console.log(err)\n\n  g_vm.loading_3rdparty = false\n\n  let html =  '    <div class=\\"input-group mt-2\\">' +\n          '      <select id=\\"jitbitRecipients\\" class=\\"form-control\\">'\n\n  let i\n  for(i=0; i < data.length; i+=1) {\n    html += '        <option value=\\"' + data[i].UserID + '\\">' + data[i].FullName + ' (' + data[i].Username + ')</option>'\n  }\n\n  html += '      </select>' +\n          '      <div class=\\"input-group-append\\">' +\n          '        <button id=\\"addRecipient\\" class=\\"btn btn-secondary btn-small waves-effect waves-light\\"' +\n          '          type=\\"button\\">' +\n          '          <i class=\\"fas fa-plus\\"></i>' +\n          '        </button>' +\n          '        <button id=\\"removeRecipient\\" ' +\n          '          class=\\"btn btn-danger btn-small waves-effect waves-light\\"' +\n          '          type=\\"button\\">' +\n          '          <i class=\\"fas fa-times\\"></i>' +\n          '        </button>' +\n          '      </div>' +\n          '    </div>'\n\n  $('#jitbitRecipientDiv').html(html)\n\n  $('#removeRecipient').click(function(x) {\n    $('#jitbitRecipientDiv').hide()\n    $('#addRecipientsButton').show()\n    $('#jitbitRecipients').val('')\n  })\n\n  $('#addRecipient').click(function(x) {\n    // add to list\n    console.log('Adding recipient to list')\n    addRecipient( $('#jitbitRecipients').val(), $('#jitbitRecipients').find(\\":selected\\").text())\n    // hide the form\n    $('#jitbitRecipients').val('')\n    $('#jitbitRecipientDiv').hide()\n    $('#addRecipientsButton').show()\n  })\n}\n\nexport function compute(fields) {\n\n  let x = g_vm.actions.filter((x) => x['@rid'] == fields.action_id)\n  console.log(fields)\n\n\n  let body = {\n           ...fields,\n           token: g_vm.token,\n           action_id: x[0]['@rid'],\n           credential_id: x[0].config.credential,\n           company_id: $('#jitbitCompanySelection').val(),\n           user_id: userProfile.UserID,\n           group_id: x[0].group_id,\n           category_id: $('#jitbitCategorySelection').val(),\n           priority_id: $('#jitbitPrioritySelection').val(),\n           origin: 0, // WebApp\n           case_id: g_vm.caseData['@rid'],\n           assignedToUserId: recipientList.length > 0 ? recipientList[0][0] : 0,\n           tags: fields.tags.join(','),\n           recipients : [ ]\n        }\n\n  body.recipients = recipientList.map(u => u[0])\n  \n  body.body = g_vm.data.body\n\n  console.log(body)\n  g_vm.fetchActionItem({\n    token: g_vm.token,\n    socket: g_vm.$socket,\n    callback: getEscalateResponse,\n    cmd: getModuleId(),\n    route: 'create_ticket',\n    data: body\n  })\n\n}\n\nexport function getEscalateResponse(data, err) {\n  console.log('Escalated!')\n  console.log(data)\n  console.log(err)\n\n  g_vm.newTicketListener(data, err)\n}\n"},{"@rid":"#1017:0","group_id":"d5b8e698-89f1-4222-8585-f06ab4e83649","name":"ChatGPT Lookup","description":"LLM lookup","app_id":"#397:0","module":"playbook.investigate.DataEnrichment","config":{"credential":"085765ff-9b44-498d-8fd5-2aa644bc00f7"},"enabled":true,"dateUpdated":"2025-06-03T17:17:56.000Z","dateAdded":"2025-06-03T17:16:48.000Z","category_id":"investigate","action_id":"playbook.investigate.DataEnrichment","module_id":"chatgpt","code":"//! Global vm for interacting with base\nlet g_vm;\n\n//! Get Module ID - return the name/key/id of this function. Must match with app data inside marketplace\nexport function getModuleId() { return \"chatgpt\"; }\n\n//! Write ID - actionItems\nexport function showActionSettings(vm) {\n  g_vm = vm\n}\n\nexport function getActionResponse(data, err) {\n  g_vm.loading_3rdparty = false\n\n  console.log(data)\n  console.log(err)\n  if(!data) {\n    console.log(\"Failed to prompt. need to retry\")\n    g_vm.token = \"\"\n    g_vm.$bvModal.show(\"token-modal\")\n    return\n  }\n\n  //! build our data selects - Company, Reporter, Priority, Category\n  console.log(\"Adding chatgpt response to Artefacts, data type is enrichment\")\n  g_vm.addAsArtefact(\"enrichment\",  data.content, data)\n\n}\n\n//! Destructor - Remove all added fields\nexport function removeFields() {\n  return\n}\n\n\nexport function compute(fields) {\n  console.log(fields)\n  // get categories and\n  if(!g_vm.token || g_vm.token.length == 0) {\n    g_vm.$bvModal.show(\"token-modal\")\n    return\n  }\n\n  let x = g_vm.actions.filter((x) => x[\"@rid\"] == fields.action_id)\n  let body = { token: g_vm.token, action_id: x[0][\"@rid\"], credential_id: x[0].config.credential, group_id: x[0].group_id, \"body\" : fields.text }\n  g_vm.loading_3rdparty = true\n  console.log(\"BODY\")\n  console.log(body)\n  g_vm.fetchActionItem({\n    token: g_vm.token,\n    socket: g_vm.$socket,\n    callback: getActionResponse,\n    cmd: getModuleId(),\n    route: \"search\",\n    data: body\n  })\n\n}\n\n\nexport function formatText(data_str, record)  {\n  return data_str\n}\n"},{"@rid":"#1016:0","group_id":"d5b8e698-89f1-4222-8585-f06ab4e83649","name":"VirusTotal Host Reputation","description":"Reputation","app_id":"#402:1","module":"playbook.investigate.HostReputation","config":{"credential":"ef1cbd98-fc6b-41e6-a55e-ee5b1ae6ab23"},"enabled":true,"dateUpdated":"2025-06-03T17:16:03.000Z","dateAdded":"2025-06-03T17:16:03.000Z","category_id":"investigate","action_id":"playbook.investigate.HostReputation","module_id":"virustotal-host","code":"//! Global vm for interacting with base\nlet g_vm;\n\n//! Get Module ID - return the name/key/id of this function. Must match with app data inside marketplace\nexport function getModuleId() { return \"virustotal-host\"; }\n\n//! Write ID - actionItems\nexport function showActionSettings(vm) {\n  g_vm = vm\n}\n\nexport function getActionResponse(data, err) {\n\n  g_vm.loading_3rdparty = false\n  console.log(data)\n  console.log(err)\n\n  if(err && err.toLowerCase().indexOf(\"success\") == -1) {\n       return g_vm.$bvModal.msgBoxOk(err).then((x) => {\n       return\n    })\n  }\n\n  if(!data) {\n    console.log(\"Failed to prompt. need to retry\")\n    g_vm.token = \"\"\n    g_vm.$bvModal.show(\"token-modal\")\n    return\n  }\n\n\n  //! build our data selects - Company, Reporter, Priority, Category\n  console.log(\"Adding response to Artefacts, data type is url\")\n  let mal = false\n  console.log(data.data.attributes)\n  console.log(data.data.attributes.last_analysis_stats)\n  if(data.data.attributes.last_analysis_stats.malicious > 0 || data.data.attributes.last_analysis_stats.suspicious > 0) mal = true\n  g_vm.addAsArtefact(\"enrichment\",  data.data.attributes.last_analysis_results, data.data, mal)\n\n}\n\n//! Destructor - Remove all added fields\nexport function removeFields() {\n  return\n}\n\n\nexport function compute(fields) {\n  console.log(fields)\n  // get categories and\n  if(!g_vm.token || g_vm.token.length == 0) {\n    g_vm.loading_3rdparty = false\n    g_vm.$bvModal.show(\"token-modal\")\n    return\n  }\n\n  let x = g_vm.actions.filter((x) => x[\"@rid\"] == fields.action_id)\n  let body = { token: g_vm.token, action_id: x[0][\"@rid\"], credential_id: x[0].config.credential, group_id: x[0].group_id, \"body\" : fields.text }\n  g_vm.loading_3rdparty = true\n  console.log(\"BODY\")\n  console.log(body)\n  g_vm.fetchActionItem({\n    token: g_vm.token,\n    socket: g_vm.$socket,\n    callback: getActionResponse,\n    cmd: getModuleId(),\n    route: \"search\",\n    data: body\n  })\n\n}\n\nexport function format(data_str, record) {\n      //let data = JSON.parse(data_str)\n      console.log(record)\n      if ('data' in record) \n          record = record.data\n      try {\n\n      let data = record.attributes.last_analysis_results\n      let keys = Object.keys(data)\n      let i\n      let html ='<table class=\\"table table-condensed\\">'\n\n     let data2 = [ ]\n     for(i=0; i < keys.length; i+=1) {\n       data2.push(  {  ...data[ keys[ i ] ], key: keys[i] } )\n     }\n\n     data2 = data2.sort(customSort)\n\n     for(i=0; i < data2.length; i+=1) {\n        let r = data2[ i ]\n\n        html += '<tr><td>' + r.key + '</td><td><span data-toggle=\\"tooltip\\" data-placement=\\"top\\" title=\\"Method: ' + r.method + ', Engine: ' + r.engine_name + ', Category: ' + r.category + '\\">'\n\n        if(r.result == 'clean' || r.result == 'unrated') {\n          html += '<div class=\\"d-inline-flex align-items-center\\"><div class=\\"p-1 mr -2\\"><i class=\\"fas fa-check text-success\\"></i></div><div>' + capitalizeFirstLetter(r.result) + '</div></div>' \n        } else {\n          html += '<div class=\\"d-inline-flex align-items-center\\"><div class=\\"p1 mr-2\\"><i class=\\"fas fa-exclamation text-danger\\"></i></div><div>' + capitalizeFirstLetter(r.result) + '</div></div>' \n        }\n\n        html += '</span></td></tr>'\n     }\n\n      return html + '</table>'\n     } catch (e) {\n      console.log(e)\n      return JSON.stringify(record)\n     }\n}\n\nexport function formatText(data_str, record) {\n\n     console.log(record)\n      if ('data' in record) \n          record = record.data\n     try {\n     let data = record.attributes.last_analysis_results\n     let keys = Object.keys(data)\n     let i\n     let txt =''\n\t  \n     let data2 = [ ]\n     for(i=0; i < keys.length; i+=1) {\n       data2.push(  {  ...data[ keys[ i ] ], key: keys[i] } )\n     }\n\n     data2 = data2.sort(customSort)\n\n     for(i=0; i < data2.length; i+=1) {\n        let r = data2[ i ]\n        txt += \"\\t\" + r.key + ': Method: ' + r.method + ', Engine: ' + r.engine_name + ', Category: ' + r.category + \", Status: \" + capitalizeFirstLetter(r.result) + \"\\n\"\n     }\n     return txt\n     } catch (e) {\n\n      console.log(e)\n      return JSON.stringify(record)\n     }\n}\n\nexport function customSort(a, b) {\n    // Check if result is 'unrated' or empty\n    if (a.result === 'unrated' || a.result === 'clean') {\n        return 1; // 'a' has higher priority\n    } else if (b.result === 'unrated' || b.result === 'clean') {\n        return -1; // 'b' has higher priority\n    } else {\n        // Compare by the 'result' key\n        return a.key.localeCompare(b.key);\n    }\n}\n\nexport function capitalizeFirstLetter (string) {\n    const [firstLetter, ...rest] = string;\n    return firstLetter.toUpperCase() + rest.join('');\n}\n\n"},{"@rid":"#1015:0","group_id":"d5b8e698-89f1-4222-8585-f06ab4e83649","name":"VirusTotal URL Reputation","description":null,"app_id":"#403:1","module":"playbook.investigate.URLReputation","config":{"credential":"ef1cbd98-fc6b-41e6-a55e-ee5b1ae6ab23"},"enabled":true,"dateUpdated":"2025-06-03T17:14:21.000Z","dateAdded":"2025-06-03T17:14:21.000Z","category_id":"investigate","action_id":"playbook.investigate.URLReputation","module_id":"virustotal-url","code":"//! Global vm for interacting with base\nlet g_vm;\n\n//! Get Module ID - return the name/key/id of this function. Must match with app data inside marketplace\nexport function getModuleId() { return \"virustotal-url\"; }\n\n//! Write ID - actionItems\nexport function showActionSettings(vm) {\n  g_vm = vm\n}\n\nexport function getActionResponse(data, err) {\n\n  g_vm.loading_3rdparty = false\n\n  console.log(data)\n  console.log(err)\n  if(!data) {\n    console.log(\"Failed to prompt. need to retry\")\n    g_vm.token = \"\"\n    g_vm.$bvModal.show(\"token-modal\")\n    return\n  }\n\n  if(data.attributes.status.toLowerCase() == 'queued') {\n    return g_vm.$bvModal.msgBoxOk('Your request has currently been queued.  Please wait a moment and try your request again.').then((x) => {\n       return\n    })\n  }\n\n  // lookup available users by company\n\n\n  //! build our data selects - Company, Reporter, Priority, Category\n  console.log(\"Adding response to Artefacts, data type is url\")\n  let mal = false\n  if(data.attributes.stats.malicious > 0 || data.attributes.stats.suspicious > 0) mal = true\n  g_vm.addAsArtefact(\"enrichment\",  data.attributes.results, data, mal)\n\n}\n\n//! Destructor - Remove all added fields\nexport function removeFields() {\n  return\n}\n\n\nexport function compute(fields) {\n  console.log(fields)\n  if(!g_vm.token || g_vm.token.length == 0) {\n\n    g_vm.loading_3rdparty = false\n    g_vm.$bvModal.show(\"token-modal\")\n    return\n  }\n\n  // get categories and\n  let x = g_vm.actions.filter((x) => x[\"@rid\"] == fields.action_id)\n  let body = { token: g_vm.token, action_id: x[0][\"@rid\"], credential_id: x[0].config.credential, group_id: x[0].group_id, \"body\" : fields.text }\n  g_vm.loading_3rdparty = true\n  console.log(\"BODY\")\n  console.log(body)\n  g_vm.fetchActionItem({\n    token: g_vm.token,\n    socket: g_vm.$socket,\n    callback: getActionResponse,\n    cmd: getModuleId(),\n    route: \"search\",\n    data: body\n  })\n\n}\n\nexport function format(data_str, record) {\n      console.log(record)\n      console.log(data_str)\n      if ('data' in record) \n          record = record.data\n      console.log(\"URL Artefact\")\n      try {\n      //let data = JSON.parse(data_str)\n      let data = record.attributes.results\n      let keys = Object.keys(data)\n      let i\n      let html ='<table class=\\"table table-condensed\\">'\n\n     let data2 = [ ]\n     for(i=0; i < keys.length; i+=1) {\n       data2.push(  {  ...data[ keys[ i ] ], key: keys[i] } )\n     }\n\n     data2 = data2.sort(customSort)\n\n     for(i=0; i < data2.length; i+=1) {\n        let r = data2[ i ]\n\n        html += '<tr><td>' + r.key + '</td><td><span data-toggle=\\"tooltip\\" data-placement=\\"top\\" title=\\"Method: ' + r.method + ', Engine: ' + r.engine_name + ', Category: ' + r.category + '\\">'\n\n        if(r.result == 'clean' || r.result == 'unrated') {\n          html += '<div class=\\"d-inline-flex align-items-center\\"><div class=\\"p-1 mr -2\\"><i class=\\"fas fa-check text-success\\"></i></div><div>' + capitalizeFirstLetter(r.result) + '</div></div>' \n        } else {\n          html += '<div class=\\"d-inline-flex align-items-center\\"><div class=\\"p1 mr-2\\"><i class=\\"fas fa-exclamation text-danger\\"></i></div><div>' + capitalizeFirstLetter(r.result) + '</div></div>' \n        }\n\n        html += '</span></td></tr>'\n     }\n\n      return html + '</table>'\n     } catch (e) {\n      return JSON.stringify(record)\n     }\n}\n\nexport function formatText(data_str, record) {\n\n     console.log(record)\n      if ('data' in record) \n          record = record.data\n     try {\n     let data = record.attributes.results\n     let keys = Object.keys(data)\n     let i\n     let txt =''\n\t  \n     let data2 = [ ]\n     for(i=0; i < keys.length; i+=1) {\n       data2.push(  {  ...data[ keys[ i ] ], key: keys[i] } )\n     }\n\n     data2 = data2.sort(customSort)\n\n     for(i=0; i < data2.length; i+=1) {\n        let r = data2[ i ]\n        txt += r.key + ': Method: ' + r.method + ', Engine: ' + r.engine_name + ', Category: ' + r.category + \", Status: \" + capitalizeFirstLetter(r.result) + \"\\n\"\n     }\n\n     return txt\n     } catch (e) {\n      return JSON.stringify(record)\n     }\n}\n\nexport function customSort(a, b) {\n    // Check if result is 'unrated' or empty\n    if (a.result === 'unrated' || a.result === 'clean') {\n        return -1; // 'a' has higher priority\n    } else if (b.result === 'unrated' || b.result === 'clean') {\n        return 1; // 'b' has higher priority\n    } else {\n        // Compare by the 'result' key\n        return a.key.localeCompare(b.key);\n    }\n}\n\nexport function capitalizeFirstLetter (string) {\n    const [firstLetter, ...rest] = string;\n    return firstLetter.toUpperCase() + rest.join('');\n}\n\n"}],"status":true,"code":200,"details":"Successfully fetched 18 records."}
